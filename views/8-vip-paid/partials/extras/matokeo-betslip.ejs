<% const trh = new Date(jana.split('/').reverse().join('-')).toLocaleDateString('en-US', { day: 'numeric', month: 'short', year: 'numeric', timeZone: 'Africa/Nairobi' }) %>
<% const toNumber = (value) => Number(value || 1); %>
<% const totalVipOdds = (toNumber(total_odds?.betslip1) * toNumber(total_odds?.betslip2) * toNumber(total_odds?.betslip3)).toFixed(2); %>
<% const splitTeams = (matchValue = "") => { %>
<%   const normalized = String(matchValue || "").replace(" vs ", " - "); %>
<%   const parts = normalized.split(" - "); %>
<%   const home = (parts.shift() || normalized).trim(); %>
<%   const away = parts.length ? parts.join(" - ").trim() : ""; %>
<%   return { home, away }; %>
<% }; %>

<div class="vip-card-wrapper vip-showcase mx-auto">
    <div class="vip-promo-card">
        <div class="card-header vip-showcase-header">
            <div class="vip-badge">VIP TIPS - <%= trh %></div>
            <h2 class="mb-1 fw-extrabold text-white" style="font-weight: 800;">MATOKEO YA VIP JANA</h2>
            <p class="mb-0 text-white-50 fw-semibold">Mechi za VIP zilizoshinda Jana! ðŸ”¥</p>
        </div>

        <div class="card-body vip-showcase-body py-4 px-2 py-md-4 px-md-4">
            <div class="vip-slip-matches">
                <% if (supa_won && supa_won.length > 0) { %>
                <% supa_won.forEach(match => { %>
                <div class="vip-slip-row">
                    <div class="vip-row-left">
                        <div class="vip-row-meta">
                            <span class="vip-pill">
                                <i class="fa-regular fa-calendar"></i>
                                <%= match?.date || '--/--/----' %>
                            </span>
                            <span class="vip-pill">
                                <i class="fa-regular fa-clock"></i>
                                <%= match?.time || '--:--' %>
                            </span>
                            <span class="vip-pill vip-pill-league">
                                <i class="fa-solid fa-trophy"></i>
                                <%= match?.league || 'League' %>
                            </span>
                        </div>
                        <% const teams = splitTeams(match?.match); %>
                        <div class="vip-row-match">
                            <div class="vip-team"><%= teams.home || '-' %></div>
                            <% if (teams.away) { %>
                            <div class="vip-team vip-team-away"><%= teams.away %></div>
                            <% } %>
                        </div>
                        <div class="vip-tip-pill">
                            <%= match.tip %>
                        </div>
                    </div>

                    <div class="vip-row-odds">
                        <span class="vip-odds-pill text-success" title="Odds Locked" style="width: fit-content;">
                            <%= match?.result %>
                        </span>
                    </div>
                </div>
                <% }) %>
                <% } %>
                <!-- If there is no supa won results -->
                <% if (supa_won && supa_won.length === 0) { %>
                <div class="vip-empty">Matokeo ya jana bado hayajawekwa kwa sasa.</div>
                <% } %>
            </div>

            <button class="unlock-btn vip-unlock-btn d-flex align-items-center justify-content-center gap-2"
                onclick="ScrollToLipiaBtn2()">
                LIPIA VIP <i class="fa-solid fa-arrow-up ms-2"></i>
            </button>
        </div>
    </div>
</div>


<script>
    function ScrollToLipiaBtn2() {
        const lipiaSection = document.getElementById('article-gate');
        if (lipiaSection) {
            lipiaSection.scrollIntoView({ behavior: 'smooth' });
        }
    }
</script>